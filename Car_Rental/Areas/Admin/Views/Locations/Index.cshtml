@model IEnumerable<Car_Rental.Models.Location>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<h4>Liste des locations:</h4>
<hr />

<table class="table table-bordered">
    <tr class="bg-light">
        <th>
            Nom du client
        </th>
        <th>
            Image du véhicule
        </th>
        <th>
            Type de location
        </th>
        <th>
            Date de debut
        </th>
        <th>
            Date de fin
        </th>
        <th>
            Montant total
        </th>
        <th>
            Etat de location
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        <tr class="bg-white">
            <td>
                @Html.DisplayFor(modelItem => item.Client.Nom_complet)
            </td>
            <td>
                <img src="@Url.Content("~/Content/Images/"+@item.Voiture.Image)" alt="@Html.DisplayFor(modelItem => item.Voiture.Type_carburant)" width="120" height="80">
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.type_location)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.date_debut)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.date_fin)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.prix_location_total) Dhs
            </td>
            <td>
                <span class="@(item.Etat_location == "En attente" ? "badge badge-warning" : "badge badge-success")" style="font-size:13px">
                    @Html.DisplayFor(modelItem => item.Etat_location)

                </span>

            </td>
            <td>
                <div class="d-flex justify-content-between">
                    <a href="@Url.Action("Delete", "Locations",new { idC = item.id_client, idV = item.Id_voiture })"
                       class="btn btn-danger btn-sm"
                       onclick="return confirm('Êtes-vous sûr? ')">
                        <i class="fas fa-trash"></i>
                    </a>

                    @if (item.Etat_location == "En attente")
                    {
                        using (Html.BeginForm("ValidateReservation", "Locations", FormMethod.Post))
                        {
                            @Html.AntiForgeryToken()

                            <input type="hidden" name="id_client" id="id_client" value="@item.id_client" />
                            <input type="hidden" name="id_voiture" id="id_voiture" value="@item.Id_voiture" />
                            <button type="submit" class="btn btn-success btn-sm">
                                <i class="fas fa-check"></i>
                            </button>
                        }
                    }
                </div>

            </td>
        </tr>
    }

</table>
